<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>2025ë…„ 3ì°¨ ì²´í—˜í•™ìŠµ ì¶œì„ì²´í¬</title>
<style>
  :root {
    --blue: #2563eb;
    --blue-600:#1d4ed8;
    --blue-light: #dbeafe;
    --purple: #8b5cf6;
    --gradient: linear-gradient(90deg, #3b82f6, #8b5cf6);
    --gray: #f8fafc;
    --border: #e2e8f0;
    --text:#0f172a;
  }
  *{box-sizing:border-box}
  body { margin: 0; font-family: 'Pretendard','Malgun Gothic',system-ui,sans-serif; background: #f3f6fb; color:var(--text); }
  header { background: var(--gradient); color: #fff; text-align: center; padding: 20px 10px; border-bottom-left-radius: 20px; border-bottom-right-radius: 20px; position:sticky; top:0; z-index: 10; }
  header h1 { font-size: 22px; margin: 0; }
  header p { margin: 6px 0 0; font-size: 14px; opacity: .95; }

  /* Tabs */
  .tabs { display: flex; gap: 8px; overflow:auto; white-space:nowrap; background:#fff; padding:10px; box-shadow:0 2px 6px rgba(0,0,0,.05) }
  .tab { padding: 8px 14px; border-radius: 999px; background: #f1f5f9; border: 1px solid var(--border); cursor: pointer; transition: .2s; font-weight:600; }
  .tab.active { background: var(--blue); color:#fff; border-color: var(--blue-600); }

  /* Stats */
  .stats-container { display: grid; grid-template-columns: repeat(4, 1fr); gap: 16px; text-align: center; margin: 18px auto; max-width: 1100px; padding: 0 14px; }
  .stat-card { background:#fff; border-radius: 14px; border:1px solid var(--border); padding: 14px; }
  .stat-value { font-size: 22px; color: var(--blue); font-weight: 800; }
  .stat-label { font-size: 13px; color:#475569; }

  /* Controls */
  .controls { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin: 6px 0 16px; padding: 0 14px; }
  .btn { border:none; border-radius:10px; padding:9px 14px; font-weight:700; cursor:pointer; }
  .btn-blue { background: var(--blue); color:#fff; }
  .btn-gray { background:#e2e8f0; color:#1e293b; }
  .btn-green { background:#10b981; color:#fff; }

  /* Table */
  .table-wrap{ max-width:1100px; margin:0 auto; padding: 0 14px; }
  .table-scroller{ overflow:auto; border-radius:14px; border:1px solid var(--border); background:#fff; }
  table { width: 100%; border-collapse: collapse; min-width: 760px; }
  th, td { padding: 10px 12px; text-align: center; border-bottom: 1px solid var(--border); }
  thead { background: var(--gray); position:sticky; top:0; z-index:1; }
  tbody tr.present { background: var(--blue-light); }
  tbody tr:hover { background: #f9fafb; }
  td[contenteditable]{ outline: none; }
  .chip{display:inline-block; padding:4px 8px; border-radius:999px; background:#fee2e2; color:#991b1b; font-size:12px;}

  /* Footer overall */
  .footer { margin-top: 22px; background: var(--gradient); color:#fff; padding: 18px; text-align: center; border-top-left-radius: 20px; border-top-right-radius: 20px; }
  .footer .summary { display:flex; justify-content:center; flex-wrap:wrap; gap:10px; }
  .badge { background: rgba(255,255,255,.2); border-radius: 999px; padding: 8px 14px; font-weight:600; }

  /* Responsive */
  @media (max-width: 900px){ .stats-container{ grid-template-columns: repeat(2,1fr);} }
  @media (max-width: 520px){
    header h1{font-size:18px}
    .stat-value{font-size:18px}
    table{min-width:640px}
    .btn{padding:10px 12px}
  }
</style>
</head>
<body>
  <header>
    <h1>ğŸ“‹ 2025ë…„ 3ì°¨ ì²´í—˜í•™ìŠµ ì¶œì„ì²´í¬</h1>
    <p>2025ë…„ 10ì›” 17ì¼ (ê¸ˆ) Â· ì†¡ë„ ì²´í—˜í•™ìŠµ</p>
  </header>

  <nav class="tabs" id="tabs"></nav>

  <section class="stats-container">
    <div class="stat-card"><div class="stat-value" id="totalCount">0</div><div class="stat-label">ì „ì²´</div></div>
    <div class="stat-card"><div class="stat-value" id="presentCount">0</div><div class="stat-label">ì¶œì„</div></div>
    <div class="stat-card"><div class="stat-value" id="absentCount">0</div><div class="stat-label">ê²°ì„</div></div>
    <div class="stat-card"><div class="stat-value" id="rate">0%</div><div class="stat-label">ì¶œì„ë¥ </div></div>
  </section>

  <div class="controls">
    <button class="btn btn-gray" id="selectAll">ì „ì²´ ì„ íƒ</button>
    <button class="btn btn-gray" id="clearAll">ì „ì²´ í•´ì œ</button>
    <button class="btn btn-green" id="saveCSV">ì €ì¥í•˜ê¸°</button>
  </div>

  <div class="table-wrap">
    <div class="table-scroller">
      <table aria-label="ì¶œê²° í…Œì´ë¸”">
        <thead>
          <tr>
            <th style="width:72px">ì¶œì„</th>
            <th style="width:92px">í•™ë²ˆ</th>
            <th style="min-width:120px">ì´ë¦„</th>
            <th style="min-width:110px">ì§€ê°</th>
            <th style="min-width:110px">ì¡°í‡´</th>
            <th style="min-width:140px">ì¤‘ì‹</th>
            <th style="min-width:140px">í”„ë¡œê·¸ë¨</th>
          </tr>
        </thead>
        <tbody id="tbody"></tbody>
      </table>
    </div>
  </div>

  <footer class="footer">
    <h3 style="margin:6px 0 10px">ğŸ“Š ì „ì²´ ì¶œì„ í˜„í™©</h3>
    <div class="summary" id="overall"></div>
  </footer>

<script>
// ====== ë°ì´í„° ì´ˆê¸°í™” ======
const classes = [
  { id: '2-1', name: '2-1ë°˜', size: 27 },
  { id: '2-2', name: '2-2ë°˜', size: 29 },
  { id: '2-3', name: '2-3ë°˜', size: 28 },
  { id: '2-4', name: '2-4ë°˜', size: 28 },
  { id: '2-5', name: '2-5ë°˜', size: 24 },
  { id: '2-6', name: '2-6ë°˜', size: 27 },
  { id: '2-7', name: '2-7ë°˜', size: 26 },
  { id: '2-8', name: '2-8ë°˜', size: 29 },
];

// ê¸°ë³¸ ë°ì´í„°(ë°˜ë³„ ì´ë¦„/ì¤‘ì‹/í”„ë¡œê·¸ë¨)
const defaultsData = {
  '2-1': [
    {no:20102,name:'ë°•ì±„ì˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20103,name:'ì„œì•„ì—°',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'í´ë¼ì´ë°'},
    {no:20104,name:'ì†¡ì§€í˜œ',lunch:'ì •ì”¨í•¨ë°•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20105,name:'ì‹¬ì˜ˆì§€',lunch:'í˜¸ë­ì´ê³³ê°„',program:'í´ë¼ì´ë°'},
    {no:20106,name:'ì•ˆì†Œì§„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20107,name:'ì•ˆìœ ë¦¼',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20108,name:'ìš°ì€ì •',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³´ë“œ ê²Œì„'},
    {no:20109,name:'ìœ¤ì±„ì›',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³´ë“œ ê²Œì„'},
    {no:20110,name:'ì´ì„œì •',lunch:'ì •ì”¨í•¨ë°•',program:'ë³¼ë§'},
    {no:20111,name:'ì´ì†¡í˜„',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20112,name:'ì´ì˜ˆì›',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20113,name:'ì´ìœ ì§„',lunch:'ì •ì”¨í•¨ë°•',program:'í´ë¼ì´ë°'},
    {no:20114,name:'ì´íš¨ë¦°',lunch:'í˜¸ë­ì´ê³³ê°„',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20115,name:'ì´íš¨ë¦¼',lunch:'ì •ì”¨í•¨ë°•',program:'í´ë¼ì´ë°'},
    {no:20116,name:'ì¥í•˜ì˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20117,name:'ì¡°ì˜ˆì§„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20118,name:'ìµœìœ¤ì˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'í´ë¼ì´ë°'},
    {no:20119,name:'í•œê°€ì˜¨',lunch:'ì •ì”¨í•¨ë°•',program:'í´ë¼ì´ë°'},
    {no:20120,name:'ê¹€ê±´í¬',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20121,name:'ê¹€ì§€ì„­',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20122,name:'ì„œì§€ì›',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³¼ë§'},
    {no:20123,name:'ì†¡ë¯¼ì¬',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë³¼ë§'},
    {no:20124,name:'ì—„íƒœì›',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20125,name:'ìœ í™˜ì¤€',lunch:'ì •ì”¨í•¨ë°•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20126,name:'ìœ¤ì •ë¯¼',lunch:'íˆë…¸ì•„ì§€',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20127,name:'ì •ì§€ì›',lunch:'ë‹ˆë½•ë‚´ë½•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20128,name:'ì²œì¬ë¯¼',lunch:'í˜¸ë­ì´ê³³ê°„',program:'í´ë¼ì´ë°'},
  ],
  '2-2': [
    {no:20201,name:'ê¹€ì˜ˆì§„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20202,name:'ê¹€ì •ì—°',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³¼ë§'},
    {no:20203,name:'ê¹€ì±„ì›',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³¼ë§'},
    {no:20204,name:'ê¹€í¬ì¬',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³¼ë§'},
    {no:20205,name:'ë°•ì„ ',lunch:'íˆë…¸ì•„ì§€',program:'ë³¼ë§'},
    {no:20206,name:'ì†¡ìœ¤ì±„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20207,name:'ì‹ ì§€í˜œ',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³¼ë§'},
    {no:20208,name:'ì–‘ì€ì„œ',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20209,name:'ì˜¤ìœ ë€',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20210,name:'ì´í•˜ì€',lunch:'ì •ì”¨í•¨ë°•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20211,name:'ì •ê°€ì€',lunch:'ì •ì”¨í•¨ë°•',program:'ë³¼ë§'},
    {no:20212,name:'ì •ì—¬ì€',lunch:'ì •ì”¨í•¨ë°•',program:'ë³¼ë§'},
    {no:20213,name:'ì •ì±„ì›',lunch:'ì •ì”¨í•¨ë°•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20214,name:'ì²œì•„í˜„',lunch:'ì¨ë¸Œì›¨ì´',program:'í´ë¼ì´ë°'},
    {no:20215,name:'í™ë‹¤í˜„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³¼ë§'},
    {no:20216,name:'í™©í•˜ëŒ',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20217,name:'ê¹€ë‘í˜„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20218,name:'ê¹€ë¯¼ì¬',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
    {no:20219,name:'ë°•ë¯¼ê·œ',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20220,name:'ë°•ìš°ì£¼',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20221,name:'ì„œì€ì°¬',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20222,name:'ìœ ì‹œìš°',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³´ë“œ ê²Œì„'},
    {no:20223,name:'ìœ¤ì¬í˜',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20224,name:'ì´ì‹œë¬¸',lunch:'ì‹œì›”ì‹­ì¼',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20225,name:'ì „ë•ë¯¼',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20226,name:'ìµœí•œê²°',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20227,name:'ìµœí˜„ì„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20228,name:'í”¼ê´€í˜„',lunch:'íˆë…¸ì•„ì§€',program:'ë³¼ë§'},
    {no:20229,name:'í•œí˜¸ì§„',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
  ],
  '2-3': [
    {no:20301,name:'ê°•ìœ¤ì„œ',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë°© íƒˆì¶œ'},
    {no:20302,name:'ê¹€ê°€ì˜',lunch:'íˆë…¸ì•„ì§€',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20303,name:'ê¹€ë„ì—°',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20304,name:'ê¹€ì˜ˆìœ¨',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë°© íƒˆì¶œ'},
    {no:20305,name:'ê¹€ì§€ë¯¼',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20306,name:'ë°•ê°€ì€',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20307,name:'ë°•ì§€ì›',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20308,name:'ë°•ì±„ì€',lunch:'ì •ì”¨í•¨ë°•',program:'ë³¼ë§'},
    {no:20309,name:'ì†¡ì„œí˜„',lunch:'ì‹œì›”ì‹­ì¼',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20310,name:'ì†¡ì§€ë¯¼',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³´ë“œ ê²Œì„'},
    {no:20312,name:'ì´ì†Œë¹ˆ',lunch:'ì‹œì›”ì‹­ì¼',program:'ë°© íƒˆì¶œ'},
    {no:20313,name:'ì´ìˆ˜ë¯¼',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20314,name:'ì´í˜„ì§„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20315,name:'ì¥ì„œì§„',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20316,name:'ì¥ì„ ì˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20317,name:'ì¥ì—°ìš±',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20318,name:'í—ˆìˆ˜ë¯¼',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20319,name:'ë°•ì´í˜„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20320,name:'ì‹ í˜œì°¬',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
    {no:20321,name:'ì•ˆë™ê· ',lunch:'ì‹œì›”ì‹­ì¼',program:'ë°© íƒˆì¶œ'},
    {no:20322,name:'ì´ê²½ì¤€',lunch:'ë‹ˆë½•ë‚´ë½•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20323,name:'ì´ì„œìœ¤',lunch:'ì‹œì›”ì‹­ì¼',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20324,name:'ì„ë¯¼ìˆ˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20325,name:'ì¥ì‚°',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
    {no:20326,name:'ì¡°ì•ˆ',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20327,name:'ìµœì€í˜¸',lunch:'ì •ì”¨í•¨ë°•',program:'í´ë¼ì´ë°'},
    {no:20328,name:'í•œìŠ¹ë¦¬',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
    {no:20330,name:'í•œí˜„íƒœ',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
  ],
  '2-4': [
    {no:20401,name:'ê¹€ê°€ëŒ',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20402,name:'ê¹€íƒœí¬',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20403,name:'ë°•ì„œì˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20404,name:'ë°˜ìŠ¹í˜„',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë°© íƒˆì¶œ'},
    {no:20405,name:'ì–‘íƒœë¦°',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20406,name:'ìœ í˜„ë¹„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20407,name:'ì¡°ìˆ˜ì—°',lunch:'íˆë…¸ì•„ì§€',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20408,name:'ê°•í˜„ê·œ',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20409,name:'êµ­ì‹ ìœ ',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20410,name:'ê¶Œìˆœë²”',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
    {no:20411,name:'ê¹€ê·œë¯¼',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³´ë“œ ê²Œì„'},
    {no:20412,name:'ê¹€ë¯¼ì„œ',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³´ë“œ ê²Œì„'},
    {no:20413,name:'ê¹€ìŠ¹ê¸°',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³´ë“œ ê²Œì„'},
    {no:20414,name:'ê¹€ì¬ìœ¤',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³´ë“œ ê²Œì„'},
    {no:20415,name:'ë¥˜ì´í˜„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'í´ë¼ì´ë°'},
    {no:20416,name:'ë°•ì˜ˆì¤€',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
    {no:20417,name:'ë°•íƒœì •',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20418,name:'ì„œì—°ì¤€',lunch:'íˆë…¸ì•„ì§€',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20419,name:'ì‹¬ì •ìš°',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë°© íƒˆì¶œ'},
    {no:20420,name:'ì˜¤ìŠ¹ì°¬',lunch:'íˆë…¸ì•„ì§€',program:'í´ë¼ì´ë°'},
    {no:20422,name:'ì¥ì§„ìš°',lunch:'íˆë…¸ì•„ì§€',program:'ë°© íƒˆì¶œ'},
    {no:20423,name:'ì¡°ì¼ìš°',lunch:'ì‹œì›”ì‹­ì¼',program:'ë°© íƒˆì¶œ'},
    {no:20424,name:'ìµœì˜ì¬',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20425,name:'ìµœìœ¤í˜¸',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'í´ë¼ì´ë°'},
    {no:20426,name:'ìµœì§„í˜•',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20427,name:'í•œê·¼ìš°',lunch:'íˆë…¸ì•„ì§€',program:'ë³¼ë§'},
    {no:20428,name:'í•œëª…í ',lunch:'í˜¸ë­ì´ê³³ê°„',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20429,name:'í—ˆì§„í˜',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³´ë“œ ê²Œì„'},
  ],
  '2-5': [
    {no:20502,name:'ë°•ê°€ì—°',lunch:'ì‹œì›”ì‹­ì¼',program:'í´ë¼ì´ë°'},
    {no:20503,name:'ë°•ì±„ë¦°',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20504,name:'ë°˜ì£¼í˜„',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20505,name:'ë°°ìœ ì£¼',lunch:'ì •ì”¨í•¨ë°•',program:'ë°© íƒˆì¶œ'},
    {no:20506,name:'ë³€ì˜ˆì„œ',lunch:'ì •ì”¨í•¨ë°•',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20507,name:'ì†ë¯¼ì•„',lunch:'ì •ì”¨í•¨ë°•',program:'ë°© íƒˆì¶œ'},
    {no:20508,name:'ì†ì€ì±„',lunch:'ì •ì”¨í•¨ë°•',program:'ë°© íƒˆì¶œ'},
    {no:20509,name:'ì´ì‹œí˜„',lunch:'ì •ì”¨í•¨ë°•',program:'ë°© íƒˆì¶œ'},
    {no:20510,name:'ì´ì¸ì›',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20511,name:'ì²œì„œí¬',lunch:'ì •ì”¨í•¨ë°•',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20512,name:'ì¶”ìœ¤í¬',lunch:'ì •ì”¨í•¨ë°•',program:'ë°© íƒˆì¶œ'},
    {no:20513,name:'í™©ì‹œì›',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20515,name:'ê¶Œë™ìš°',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20517,name:'ê¹€ë™ì•„',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
    {no:20518,name:'ê¹€í•œê²°',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20519,name:'ê¹€í˜œì„±',lunch:'íˆë…¸ì•„ì§€',program:'ë³´ë“œ ê²Œì„'},
    {no:20520,name:'ë°•ë¯¼ê·œ',lunch:'ì •ì”¨í•¨ë°•',program:'í´ë¼ì´ë°'},
    {no:20521,name:'ì„œì¥ì›',lunch:'ì¨ë¸Œì›¨ì´',program:'ë°© íƒˆì¶œ'},
    {no:20522,name:'ì‹ ë™íœ˜',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20523,name:'ì´ë„í˜•',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20524,name:'ì„ìš°í˜„',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
    {no:20525,name:'ì „íƒœì–‘',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
    {no:20526,name:'ì •ì˜í›ˆ',lunch:'íˆë…¸ì•„ì§€',program:'í´ë¼ì´ë°'},
    {no:20527,name:'ìµœìœ ì§„',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
  ],
  '2-6': [
    {no:20601,name:'ê¹€ê·œë¦¼',lunch:'ì‹œì›”ì‹­ì¼',program:'í´ë¼ì´ë°'},
    {no:20602,name:'ê¹€ì‹œì—°',lunch:'íˆë…¸ì•„ì§€',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20603,name:'ê¹€ì£¼ì—°',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20604,name:'ìœ¤í•˜ë¯¼',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20605,name:'ì´ì€ì„œ',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20606,name:'ì´ì±„ë¦°',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20607,name:'ì¸ì‹œí˜„',lunch:'íˆë…¸ì•„ì§€',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20608,name:'ì •ì„¸ì—°',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20609,name:'ì²œì˜ˆì›',lunch:'ì •ì”¨í•¨ë°•',program:'ë³¼ë§'},
    {no:20610,name:'í—ˆì§€ì„ ',lunch:'ì •ì”¨í•¨ë°•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20611,name:'ê°•í¬ì„±',lunch:'íˆë…¸ì•„ì§€',program:'ë³¼ë§'},
    {no:20612,name:'ê³ ì¤€ì„œ',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë°© íƒˆì¶œ'},
    {no:20613,name:'ê¶Œìœ¤ìš°',lunch:'íˆë…¸ì•„ì§€',program:'í´ë¼ì´ë°'},
    {no:20615,name:'ê¹€ì°¬í˜',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë³´ë“œ ê²Œì„'},
    {no:20616,name:'ê¹€í•œê²°',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20617,name:'ë³€ë³‘ìš°',lunch:'ì •ì”¨í•¨ë°•',program:'ë°© íƒˆì¶œ'},
    {no:20618,name:'ì„œëª…ì›',lunch:'íˆë…¸ì•„ì§€',program:'ë°© íƒˆì¶œ'},
    {no:20619,name:'ì„œìœ¤ë„',lunch:'ì‹œì›”ì‹­ì¼',program:'í´ë¼ì´ë°'},
    {no:20620,name:'ì•ˆì°¬í¬',lunch:'íˆë…¸ì•„ì§€',program:'ë³´ë“œ ê²Œì„'},
    {no:20621,name:'ìš©ì„ë¹ˆ',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20622,name:'ì´ë„í˜„',lunch:'ì •ì”¨í•¨ë°•',program:'í´ë¼ì´ë°'},
    {no:20623,name:'ì´ì¤€ì—°',lunch:'ì‹œì›”ì‹­ì¼',program:'ë°© íƒˆì¶œ'},
    {no:20624,name:'ì´íƒœí˜•',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20625,name:'ì´í™ë¯¼',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20626,name:'í™©ì‹œí›„',lunch:'ì‹œì›”ì‹­ì¼',program:'ë°© íƒˆì¶œ'},
    {no:20627,name:'í™©í˜„ìˆ˜',lunch:'ì‹œì›”ì‹­ì¼',program:'í´ë¼ì´ë°'},
    {no:20628,name:'ì‹ í¬ë²”',lunch:'íˆë…¸ì•„ì§€',program:'ë³´ë“œ ê²Œì„'},
  ],
  '2-7': [
    {no:20701,name:'ê¶Œì„¸ì•„',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³´ë“œ ê²Œì„'},
    {no:20702,name:'ê¹€ì§€ë¯¼',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³´ë“œ ê²Œì„'},
    {no:20703,name:'ê¹€í˜œë¦°',lunch:'ì •ì”¨í•¨ë°•',program:'ë³´ë“œ ê²Œì„'},
    {no:20704,name:'ë…¸í˜œì§€',lunch:'ì •ì”¨í•¨ë°•',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20705,name:'ìœ¤ì±„ë¹ˆ',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20706,name:'ì´ë¯¼ì±„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20707,name:'ì´ì†Œìœ¨',lunch:'ì •ì”¨í•¨ë°•',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20708,name:'ì´ìœ ê²½',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³´ë“œ ê²Œì„'},
    {no:20709,name:'ì¥ì„ ì˜',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20710,name:'ì¥ì±„ì€',lunch:'ì •ì”¨í•¨ë°•',program:'ë³´ë“œ ê²Œì„'},
    {no:20711,name:'ì±„ë‹¤ì¸',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
    {no:20713,name:'í™ì§€ìš°',lunch:'ì •ì”¨í•¨ë°•',program:'ë³´ë“œ ê²Œì„'},
    {no:20714,name:'ê¹€ì§€ì„±',lunch:'ì¨ë¸Œì›¨ì´',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20715,name:'ë‚¨ì¤€ì‹',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20716,name:'ë…¸ê°•í›ˆ',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20717,name:'ë°•ê·œì •',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20718,name:'ì—¼ìœ¤í˜¸',lunch:'í˜¸ë­ì´ê³³ê°„',program:'ë³¼ë§'},
    {no:20719,name:'ìœ¤ì˜ë¹ˆ',lunch:'ì¨ë¸Œì›¨ì´',program:'ë³¼ë§'},
    {no:20720,name:'ì´ê¸ˆí‰',lunch:'íˆë…¸ì•„ì§€',program:'ë³¼ë§'},
    {no:20721,name:'ì´ì„œìœ¨',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20722,name:'ì„ì˜ˆì¤€',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20723,name:'ì •ì„ì§„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20724,name:'ì§„í˜„ìš°',lunch:'íˆë…¸ì•„ì§€',program:'ë³¼ë§'},
    {no:20725,name:'ì°¨ìš°ì§„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20726,name:'ìµœì„±ë¯¼',lunch:'ì¨ë¸Œì›¨ì´',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20727,name:'í•˜ì„œì§„',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'VR ê°€ìƒí˜„ì‹¤'},
  ],
  '2-8': [
    {no:20801,name:'ê¶Œìœ ì •',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë°© íƒˆì¶œ'},
    {no:20802,name:'ê¹€ë¯¼ì£¼',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë°© íƒˆì¶œ'},
    {no:20803,name:'ê¹€ë¯¼ì§€',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20804,name:'ê¹€ì„œì˜',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20805,name:'ê¹€ì˜ˆë‚˜',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20806,name:'ê¹€ì˜ˆì€',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20807,name:'ê¹€ì£¼ì•„',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20808,name:'ê¹€íƒœí¬',lunch:'ì‹œì›”ì‹­ì¼',program:'ë°© íƒˆì¶œ'},
    {no:20809,name:'ì„œì€ê²½',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20810,name:'ì†¡ìœ¤ì„œ',lunch:'ì‹œì›”ì‹­ì¼',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20811,name:'ì–‘ìˆ˜ì •',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³´ë“œ ê²Œì„'},
    {no:20812,name:'ìœ¤ë‹¤ì˜',lunch:'ë‹ˆë½•ë‚´ë½•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20813,name:'ì´ë‹¤ì›',lunch:'ì‹œì›”ì‹­ì¼',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20814,name:'ì´ë³´ì˜',lunch:'ì‹œì›”ì‹­ì¼',program:'ë™ë¬¼ì¹œêµ¬'},
    {no:20815,name:'ì´ì†Œìœ¨',lunch:'ë‹ˆë½•ë‚´ë½•',program:'ë³¼ë§'},
    {no:20816,name:'ì´ì£¼ì˜',lunch:'ì •ì”¨í•¨ë°•',program:'ë³¼ë§'},
    {no:20817,name:'ì„ì§€ë¯¼',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³´ë“œ ê²Œì„'},
    {no:20818,name:'ìµœì—¬ì§„',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë³´ë“œ ê²Œì„'},
    {no:20819,name:'í•œìˆ˜ì •',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë°© íƒˆì¶œ'},
    {no:20820,name:'ê°•ë™í˜„',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³¼ë§'},
    {no:20821,name:'ê³½ìœ¤ê·¼',lunch:'ë‹ˆë½•ë‚´ë½•',program:'VR ê°€ìƒí˜„ì‹¤'},
    {no:20822,name:'ê¹€ì£¼ì—½',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20823,name:'ê¹€ì¤‘í˜¸',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20824,name:'ë…¸ì„±ìš±',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³¼ë§'},
    {no:20825,name:'ë…¸í˜•ì˜¤',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
    {no:20826,name:'ë°•ì¬ì¤€',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³¼ë§'},
    {no:20827,name:'ì„±ì‹œìš°',lunch:'ì‹œì›”ì‹­ì¼',program:'ë³¼ë§'},
    {no:20828,name:'ì „ìœ ì¤€',lunch:'ìƒ¤ì˜¤ë°”ì˜¤',program:'ë°© íƒˆì¶œ'},
    {no:20829,name:'ì •ì€ì°¬',lunch:'í¬í”ŒëŸ¬ìŠ¤í•œìš°',program:'ë³¼ë§'},
  ],
};

const LSK = (cid)=>`attendance_v2_${cid}`; // localStorage key (v2: tardy/early added)
let state = {};

function loadClass(cid){
  try{ return JSON.parse(localStorage.getItem(LSK(cid))||'null'); }catch(e){ return null; }
}
function persistClass(cid){
  try{ localStorage.setItem(LSK(cid), JSON.stringify(state[cid])); }catch(e){}
}

// ì´ˆê¸° ìƒíƒœ êµ¬ì„±: ì €ì¥ë¶„ > ê¸°ë³¸ ë°ì´í„° > placeholder
classes.forEach(c=>{
  const saved = loadClass(c.id);
  if (saved && Array.isArray(saved)) {
    state[c.id] = saved;
  } else if (defaultsData[c.id]) {
    state[c.id] = defaultsData[c.id].map(r=>({ ...r, present:false, tardy:false, early:false }));
  } else {
    state[c.id] = Array.from({length:c.size}, (_,i)=>({
      no: 20000 + i + 1,
      name: `í•™ìƒ${String(i+1).padStart(2,'0')}`,
      lunch: '', program: '', present:false, tardy:false, early:false
    }));
  }
});

// ====== UI ìš”ì†Œ ======
let activeId = classes[0].id;
const tbody   = document.getElementById('tbody');
const tabs    = document.getElementById('tabs');
const totalEl = document.getElementById('totalCount');
const presEl  = document.getElementById('presentCount');
const absEl   = document.getElementById('absentCount');
const rateEl  = document.getElementById('rate');

// ====== ë Œë”ëŸ¬ ======
function renderTabs(){
  tabs.innerHTML='';
  classes.forEach(c=>{
    const b = document.createElement('button');
    b.className = 'tab' + (c.id===activeId?' active':'');
    const count = state[c.id]?.length ?? c.size;
    b.textContent = `${c.name} (${count})`;
    b.onclick = ()=>{ activeId=c.id; renderTabs(); renderTable(); updateStats(); updateOverall(); };
    tabs.appendChild(b);
  });
}

function makeCellEditable(td, key, row){
  td.contentEditable = 'true';
  td.spellcheck = false;
  td.textContent = row[key] ?? '';
  td.addEventListener('input', ()=>{ row[key] = td.textContent.trim(); persistClass(activeId); });
}

function renderTable(){
  tbody.innerHTML='';
  state[activeId].forEach((r,idx)=>{
    const tr = document.createElement('tr');
    tr.classList.toggle('present', !!r.present);

    // ì¶œì„ ì²´í¬
    const tdChk = document.createElement('td');
    const chk = document.createElement('input'); chk.type='checkbox'; chk.checked = !!r.present;
    chk.addEventListener('change', ()=>{ r.present = chk.checked; tr.classList.toggle('present', r.present); updateStats(); updateOverall(); persistClass(activeId); });
    tdChk.appendChild(chk);

    // í•™ë²ˆ
    const tdNo = document.createElement('td'); tdNo.textContent = r.no; tdNo.title='í•™ë²ˆ';

    // ì´ë¦„
    const tdName = document.createElement('td'); makeCellEditable(tdName, 'name', r);

    // ì§€ê° / ì¡°í‡´ (checkbox)
    const tdTardy = document.createElement('td');
    const chkT = document.createElement('input'); chkT.type='checkbox'; chkT.checked=!!r.tardy; chkT.title='ì§€ê°';
    chkT.addEventListener('change', ()=>{ r.tardy = chkT.checked; persistClass(activeId); });
    tdTardy.appendChild(chkT);

    const tdEarly = document.createElement('td');
    const chkE = document.createElement('input'); chkE.type='checkbox'; chkE.checked=!!r.early; chkE.title='ì¡°í‡´';
    chkE.addEventListener('change', ()=>{ r.early = chkE.checked; persistClass(activeId); });
    tdEarly.appendChild(chkE);

    // ì¤‘ì‹ / í”„ë¡œê·¸ë¨ (í…ìŠ¤íŠ¸ ì§ì ‘ ìˆ˜ì •)
    const tdLunch = document.createElement('td'); makeCellEditable(tdLunch, 'lunch', r);
    const tdProg  = document.createElement('td'); makeCellEditable(tdProg, 'program', r);

    tr.append(tdChk, tdNo, tdName, tdTardy, tdEarly, tdLunch, tdProg);
    tbody.appendChild(tr);
  });
}

// ====== í†µê³„ ======
function updateStats(){
  const rows = state[activeId];
  const total = rows.length;
  const present = rows.filter(x=>x.present).length;
  const absent = total - present;
  const pct = total? Math.round(present/total*100) : 0;
  totalEl.textContent = total;
  presEl.textContent  = present;
  absEl.textContent   = absent;
  rateEl.textContent  = pct+"%";
}

function updateOverall(){
  let total=0, present=0;
  classes.forEach(c=>{ const arr=state[c.id]; total += arr.length; present += arr.filter(r=>r.present).length; });
  const absent = total - present;
  const pct = total? Math.round(present/total*100) : 0;
  document.getElementById('overall').innerHTML = `
    <span class='badge'>ì „ì²´ ì¸ì›: ${total}</span>
    <span class='badge'>ì¶œì„: ${present}</span>
    <span class='badge'>ê²°ì„: ${absent}</span>
    <span class='badge'>ì¶œì„ë¥ : ${pct}%</span>
  `;
}

// ====== ë²„íŠ¼ ë™ì‘ ======
const selectAllBtn = document.getElementById('selectAll');
const clearAllBtn  = document.getElementById('clearAll');
const saveBtn      = document.getElementById('saveCSV');

selectAllBtn.addEventListener('click', ()=>{ state[activeId].forEach(r=>r.present=true); renderTable(); updateStats(); updateOverall(); persistClass(activeId); });
clearAllBtn.addEventListener('click',  ()=>{ state[activeId].forEach(r=>r.present=false); renderTable(); updateStats(); updateOverall(); persistClass(activeId); });

saveBtn.addEventListener('click', ()=>{
  const rows = state[activeId];
  const header = ['ì¶œì„','í•™ë²ˆ','ì´ë¦„','ì§€ê°','ì¡°í‡´','ì¤‘ì‹','í”„ë¡œê·¸ë¨'];
  const csv = [header, ...rows.map(r=>[
    r.present?'O':'X', r.no, esc(r.name), r.tardy?'O':'', r.early?'O':'', esc(r.lunch), esc(r.program)
  ])].map(a=>a.map(csvCell).join(',')).join('\n');
  const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});
  const ts = new Date().toISOString().slice(0,19).replace(/[:T]/g,'');
  const fn = `ì¶œì„_${activeId}_${ts}.csv`;
  const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = fn; document.body.appendChild(a); a.click(); setTimeout(()=>{ URL.revokeObjectURL(a.href); a.remove(); }, 100);
});

function csvCell(v){ const s=String(v??'').replaceAll('"','""'); return /[",\n]/.test(s)?`"${s}"`:s; }
function esc(s){ return String(s||'').replace(/[\n\r,]/g,' ').trim(); }

// ====== ì´ˆê¸° ë Œë” ======
renderTabs();
renderTable();
updateStats();
updateOverall();
</script>
</body>
</html>
